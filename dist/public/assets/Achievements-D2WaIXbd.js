import{j as s}from"./ui-DDb1Cthj.js";import{r as o}from"./vendor-CbTYwD9p.js";import{u as y,a as x}from"./query-DJEuKXE5.js";import{u as C,i as b,C as r,a as c,B as h,P as v,f as p,q as d}from"./index-DP8xWL5x.js";import{c as g,l as P,z as S,G as $}from"./icons-DpVlej8W.js";import"./router-i_uqa6-9.js";import"./tonconnect-BAw8c48p.js";import"./ton-BfqU8ldO.js";import"./utils-BkWO3WEY.js";function Q(){const{toast:n}=C(),[a,j]=o.useState(null),[l,f]=o.useState("all");o.useEffect(()=>{b().then(j).catch(e=>console.error("Failed to initialize user:",e))},[]);const{data:t,isLoading:w}=y({queryKey:["/api/user",a,"achievements"],enabled:!!a}),m=x({mutationFn:async()=>(await p("POST",`/api/user/${a}/achievements/check`)).json(),onSuccess:e=>{d.invalidateQueries({queryKey:["/api/user",a,"achievements"]}),e.newlyUnlocked&&e.newlyUnlocked.length>0&&n({title:"New Achievements!",description:`Unlocked ${e.newlyUnlocked.length} achievements!`})}}),i=x({mutationFn:async e=>(await p("POST",`/api/user/${a}/achievements/${e}/claim`)).json(),onSuccess:e=>{d.invalidateQueries({queryKey:["/api/user",a,"achievements"]}),d.invalidateQueries({queryKey:["/api/user",a]}),n({title:"Reward Claimed!",description:e.message||"Achievement reward received!"})},onError:e=>{n({title:"Error",description:e.message||"Failed to claim reward",variant:"destructive"})}});if(w||!t)return s.jsx("div",{className:"min-h-screen bg-background p-3",children:s.jsx("div",{className:"max-w-5xl mx-auto",children:s.jsx(r,{className:"p-6",children:s.jsx("p",{className:"text-muted-foreground",children:"Loading achievements..."})})})});const N=["all","milestone","social","spending","mining"],u=l==="all"?t.achievements:t.achievements.filter(e=>e.category===l),k=t.unlockedCount/t.totalCount*100;return s.jsx("div",{className:"min-h-screen bg-background p-3",children:s.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-md bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center",children:s.jsx(g,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Achievements"}),s.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Unlock badges and earn rewards"})]}),s.jsxs(c,{onClick:()=>m.mutate(),disabled:m.isPending,size:"sm",variant:"outline",children:[s.jsx(P,{className:"w-4 h-4 mr-2"}),"Check Progress"]})]}),s.jsxs(r,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(g,{className:"w-5 h-5 text-yellow-500"}),s.jsx("p",{className:"font-semibold",children:"Overall Progress"})]}),s.jsxs(h,{variant:"outline",className:"text-sm",children:[t.unlockedCount," / ",t.totalCount]})]}),s.jsx(v,{value:k,className:"h-3"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:t.unlockedCount===t.totalCount?"ðŸ† Completed all achievements!":`${t.totalCount-t.unlockedCount} achievements remaining`})]}),s.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:N.map(e=>s.jsx(c,{variant:l===e?"default":"outline",size:"sm",onClick:()=>f(e),className:"whitespace-nowrap",children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(e=>s.jsx(r,{className:`p-4 transition-all ${e.unlocked?"bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border-yellow-500/50":"bg-muted/30"}`,children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:`flex-shrink-0 w-16 h-16 rounded-full flex items-center justify-center text-3xl ${e.unlocked?"bg-gradient-to-br from-yellow-500 to-orange-500":"bg-muted"}`,children:e.unlocked?s.jsx("span",{children:e.badgeIcon||"ðŸ†"}):s.jsx(S,{className:"w-6 h-6 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-base",children:e.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]}),s.jsx(h,{variant:e.unlocked?"default":"outline",className:`text-xs flex-shrink-0 ${e.unlocked?"bg-yellow-500":""}`,children:e.category})]}),(e.rewardCs||e.rewardChst||e.rewardItem)&&s.jsxs("div",{className:"flex items-center gap-2 mt-3 p-2 bg-background/50 rounded",children:[s.jsx($,{className:"w-4 h-4 text-matrix-green"}),s.jsxs("span",{className:"text-xs font-mono text-matrix-green",children:[e.rewardCs&&`${e.rewardCs.toLocaleString()} CS`,e.rewardChst&&` + ${e.rewardChst} CHST`,e.rewardItem&&` + ${e.rewardItem}`]})]}),e.unlocked&&e.unlockedAt&&s.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Unlocked ",new Date(e.unlockedAt).toLocaleDateString()]}),e.unlocked&&e.rewardCs&&s.jsx(c,{size:"sm",className:"mt-3 w-full",onClick:()=>i.mutate(e.achievementId),disabled:i.isPending,children:i.isPending?"Claiming...":"Claim Reward"})]})]})},e.achievementId))}),u.length===0&&s.jsx(r,{className:"p-6",children:s.jsx("p",{className:"text-center text-muted-foreground",children:"No achievements in this category yet."})}),s.jsx(r,{className:"p-4 bg-muted/30",children:s.jsxs("p",{className:"text-sm text-muted-foreground",children:["ðŸ’¡ ",s.jsx("strong",{children:"Tip:"}),' Achievements are automatically checked when you reach milestones. Click "Check Progress" to manually check for newly unlocked achievements!']})})]})})}export{Q as default};
